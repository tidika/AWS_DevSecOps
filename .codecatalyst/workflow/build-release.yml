Name: build-and-release
SchemaVersion: "1.0"
Triggers:
  - Type: PUSH
    Branches:
      - main
      
Compute:
  Type: EC2
  InstanceType: t2.micro
  Image: ami-0195204d5dce06d99
  Region: us-east-1
  
Actions:
  build_application:
    Identifier: aws/codebuild-run@v1
    Inputs:
      Sources:
        - WorkflowSource
    Outputs:
      Artifacts:
        - Name: build_output
          ArtifactIdentifier: my-build-artifact
          Location:
            Type: S3
            BucketName: tochukwu-idika-s3-bucket
            Path: build/artifacts/
    Environment:
      Name: default_environment
      Connections:
        - Name: "930627915954"  # Replace with your connection name
          Role: CodeCatalystWorkflowDevelopmentRole-Mountpointe
    Configuration:
      Steps:
        - Run: echo "Starting CodeBuild execution"
        - Run: aws codebuild start-build --project-name your-codebuild-project-name --artifacts-override '{"type":"S3","location":"writing-reading-from-s3/build/artifacts/"}'
        - Run: echo "CodeBuild execution completed"